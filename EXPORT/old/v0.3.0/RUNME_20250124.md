# RUNME_20250124.md

**‚ö†Ô∏è RUN THIS IN ADMIN POWERSHELL WINDOW**

---

## Setup-Icons System: Execute Now

**Date:** 2025-01-24  
**Status:** ‚úÖ Production Ready  
**Version:** v0.3.1

---

## What This Does

This guide walks you through executing the icon setup automation system that was just completed. The system will:

- ‚úÖ Detect if this is your first run
- ‚úÖ Detect if your project location changed
- ‚úÖ Automatically copy and verify the icon
- ‚úÖ Cache the state for future runs
- ‚úÖ Show you the next steps for v0.3.1

---

## Prerequisites

- ‚úÖ PowerShell 5.0+ (Windows 10/11 included)
- ‚úÖ **Run as Administrator** (required for this script)
- ‚úÖ All setup scripts present in v0.3.0/

---

## Step 1: Open Admin PowerShell

```powershell
# If you haven't already:
# 1. Press Windows key
# 2. Type: powershell
# 3. Right-click "Windows PowerShell"
# 4. Click "Run as Administrator"
```

---

## Step 2: Navigate to Project

```powershell
cd C:\Users\Liam\Desktop\MatLabC++\v0.3.0
```

Verify you're in the right directory:
```powershell
pwd  # Should show: C:\Users\...\MatLabC++\v0.3.0
ls   # Should see Setup-Icons-Orchestrator.ps1
```

---

## Step 3: Execute Icon Setup (Recommended)

### Option A: Standard Auto-Detection (RECOMMENDED)
```powershell
.\Setup-Icons-Orchestrator.ps1
```

**What this does:**
- Checks if first-run or location changed
- Auto-executes if needed
- Shows status and next steps
- Caches state for future runs
- Safe to run repeatedly

**Expected Output:**
```
Pre-flight Checks:
  [OK] Setup-Icons-Auto.ps1 found
  [OK] Project root validated

Current Status:
  [INFO] First execution (no cache)
  [OK] Icon asset will be created

Execution (auto mode):
  [OK] Setup-Icons-Auto.ps1 completed

Post-execution Validation:
  [OK] Icon asset verified

Next Steps for v0.3.1 Installer:
  1. Update CMakeLists.txt version to 0.3.1
  2. Build Release executable
  3. Review: installers/MatLabCpp_Setup_v0.3.1.iss
  4. Compile installer with Inno Setup
  5. Test on clean Windows VM
```

### Option B: Check Status Only (No Changes)
```powershell
.\Setup-Icons-Orchestrator.ps1 -Profile verify
```

### Option C: Force Re-run (Debugging)
```powershell
.\Setup-Icons-Orchestrator.ps1 -Profile force
```

### Option D: Preview (What Would Happen)
```powershell
.\Setup-Icons-Orchestrator.ps1 -Profile preview
```

---

## Step 4: Verify Success

After running, check:

```powershell
# Should exist and contain icon:
ls assets\icon.ico

# Should show cache state:
cat .setup-icons-cache.json | ConvertFrom-Json | Format-List
```

**Expected Result:**
```
SourceIcon    : C:\...\v0.3.0\v0.3.0\icon.ico
DestIcon      : C:\Users\Liam\Desktop\MatLabC++\v0.3.0\assets\icon.ico
Success       : True
Environment   : @{ProjectRoot=...; Hostname=...; Username=...}
LastExecution : @{Success=True; Timestamp=2025-01-24T...}
```

---

## Step 5: Continue with v0.3.1 Setup

### 5.1: Update CMakeLists.txt Version

```powershell
# Open in your editor:
notepad CMakeLists.txt

# Find line:
# project(MatLabCpp VERSION 0.3.0 ...

# Change to:
# project(MatLabCpp VERSION 0.3.1 ...

# Save and close
```

### 5.2: Build Release Executable

```powershell
# Create build directory (if not exists)
mkdir build
cd build

# Configure for Release
cmake -DCMAKE_BUILD_TYPE=Release ..

# Build
cmake --build . --config Release

# Should create: build\Release\matlabcpp.exe
ls Release\matlabcpp.exe
```

### 5.3: Review Installer Configuration

```powershell
# Navigate to installers
cd ..\installers

# Review installer script (in text editor)
notepad MatLabCpp_Setup_v0.3.1.iss

# Key things to check:
# - SetupIconFile=..\assets\icon.ico  ‚Üê Should be correct
# - Source paths for executable
# - Command wrapper files included
```

### 5.4: Compile Installer

```powershell
# If Inno Setup is installed:
# Open MatLabCpp_Setup_v0.3.1.iss in Inno Setup GUI
# Build ‚Üí Compile
# Should create: Output\MatLabCpp_Setup_v0.3.1.exe

# Or from command line (if configured):
iscc MatLabCpp_Setup_v0.3.1.iss
```

### 5.5: Test Installer

```powershell
# On a clean Windows VM:
# 1. Run: Output\MatLabCpp_Setup_v0.3.1.exe
# 2. Follow installation wizard
# 3. Verify:
#    - Icon displays correctly
#    - Program installed to Program Files
#    - Command wrappers (mlcpp, mlc) work
#    - PATH set correctly
```

---

## Troubleshooting

### Issue: "Cannot find Setup-Icons-Orchestrator.ps1"

**Solution:**
```powershell
# Make sure you're in v0.3.0 directory
cd C:\Users\Liam\Desktop\MatLabC++\v0.3.0

# Verify script exists
ls Setup-Icons-Orchestrator.ps1

# If not found, scripts may not have been created
# Contact developer or re-run setup
```

### Issue: "Access Denied" or "Cannot be loaded"

**Solution:**
```powershell
# Check execution policy
Get-ExecutionPolicy

# If it says "Restricted", allow scripts:
Set-ExecutionPolicy -ExecutionPolicy Bypass -Scope CurrentUser

# Re-run the setup
.\Setup-Icons-Orchestrator.ps1
```

### Issue: "Icon asset not found"

**Solution:**
```powershell
# Find the icon file
Get-ChildItem -Recurse -Filter "*.ico"

# Then run with explicit path
.\Setup-Icons.ps1 -SourceIconPath "C:\path\to\found\icon.ico" -Force
```

### Issue: "Already ran, want to force re-run"

**Solution:**
```powershell
# Reset cache and re-run
.\Setup-Icons-Auto.ps1 -ResetCache -Force

# Or just force run orchestrator
.\Setup-Icons-Orchestrator.ps1 -Profile force
```

---

## Quick Command Reference

```powershell
# Standard automation (most common)
.\Setup-Icons-Orchestrator.ps1

# Check status
.\Setup-Icons-Orchestrator.ps1 -Profile verify

# Force re-run
.\Setup-Icons-Orchestrator.ps1 -Profile force

# Preview
.\Setup-Icons-Orchestrator.ps1 -Profile preview

# Direct setup (if needed)
.\Setup-Icons.ps1 -Force

# Reset cache
.\Setup-Icons-Auto.ps1 -ResetCache

# Verify all scripts
.\Verify-SetupScripts.ps1

# Check cache state
cat .setup-icons-cache.json | ConvertFrom-Json | Format-List

# List icon locations
Get-ChildItem -Recurse -Filter "*.ico"

# Check installed version
cmake --version
```

---

## Files Reference

### Setup Scripts
- **Setup-Icons-Orchestrator.ps1** ‚Üê Main entry point
- **Setup-Icons-Auto.ps1** ‚Üê Smart automation
- **Setup-Icons.ps1** ‚Üê Core setup
- **Verify-SetupScripts.ps1** ‚Üê Validation

### Documentation
- **SETUP_ICONS_AUTOMATION_GUIDE.md** ‚Üê Complete guide
- **README_SETUP_ICONS.txt** ‚Üê Quick reference
- **SETUP_ICONS_IMPLEMENTATION_REPORT.md** ‚Üê Technical summary
- **SETUP_ICONS_DOCUMENTATION_INDEX.md** ‚Üê Navigation

### State Cache
- **.setup-icons-cache.json** ‚Üê Created automatically

---

## Expected Timeline

| Step | Time | Notes |
|------|------|-------|
| Icon Setup | 1-2 min | Auto-runs, cached after first time |
| Update CMakeLists.txt | 1 min | Text edit |
| Build Release | 5-10 min | Depends on system |
| Review Installer Config | 2-3 min | Text review |
| Compile Installer | 2-3 min | Inno Setup |
| Test Installer | 10-15 min | On clean VM |
| **Total** | **20-35 min** | Full pipeline |

---

## Critical Paths to Verify

### After Icon Setup
```powershell
# Icon should exist:
ls assets\icon.ico

# Cache should be created:
ls .setup-icons-cache.json
```

### After CMakeLists.txt Update
```powershell
# Version should be 0.3.1:
grep "project(MatLabCpp VERSION" CMakeLists.txt
```

### After Build
```powershell
# Executable should exist:
ls build\Release\matlabcpp.exe
```

### After Installer Compilation
```powershell
# Installer should exist:
ls installers\Output\MatLabCpp_Setup_v0.3.1.exe
```

---

## When You're Done

‚úÖ Icon setup automated and cached  
‚úÖ CMakeLists.txt updated to 0.3.1  
‚úÖ Release executable built  
‚úÖ Installer compiled  
‚úÖ Installer tested on clean VM  

### You're Ready for Release!

---

## Support

### For Help:
```powershell
# Get detailed help for any script:
Get-Help .\Setup-Icons-Orchestrator.ps1 -Full
Get-Help .\Setup-Icons-Auto.ps1 -Full
Get-Help .\Setup-Icons.ps1 -Full
```

### View Documentation:
```powershell
# Quick reference
cat README_SETUP_ICONS.txt

# Complete guide
cat SETUP_ICONS_AUTOMATION_GUIDE.md

# Navigation
cat SETUP_ICONS_DOCUMENTATION_INDEX.md
```

---

## Next: After This Session

1. ‚úÖ Run icon setup automation (this file)
2. ‚è≥ Continue with v0.3.1 build pipeline
3. ‚è≥ Test installer on Windows VM
4. ‚è≥ Create release on GitHub

---

## Session Summary

**Status:** Ready to execute  
**Date:** 2025-01-24  
**Version:** v0.3.1  
**Estimated Time:** 20-35 minutes  

### Ready? Let's go! üöÄ

```powershell
cd C:\Users\Liam\Desktop\MatLabC++\v0.3.0
.\Setup-Icons-Orchestrator.ps1
```

---

**Last Updated:** 2025-01-24  
**Created By:** GitHub Copilot  
**Status:** ‚úÖ Ready to Execute
